
<div class="container" >
    <h1>My Courses</h1>
    <table class="table mt-4">
  <thead>
    <tr>
      <th scope="col">#</th>
      <th scope="col">Course name</th>
      <th scope="col">Description</th>
      <th scope="col">Video Id</th>
      <th scope="col"></th>
      <th scope="col"></th>
    </tr>
  </thead>
  <tbody>
    {{#each courses}}
    <tr>
      <th scope="row">{{sum @index 1}}</th>
      <td>{{this.name}}</td>
      <td>{{this.description}}</td>
      <td>{{this.videoId}}</td>
      <td><a href="/courses/{{this._id}}/edit" class="btn btn-link">Edit</a></td>
      <td><button type="button" class="btn btn-link" data-bs-toggle="modal" data-bs-target="#delete-course-modal" data-bs-whatever="{{this._id}}">XÃ³a</button></td>
    </tr>
    {{else}}
            <tr>
              <td colspan="5" class="text-center">
                You haven't created course!
                <a href="/courses/create">Create course</a>
              </td>
            </tr>
    {{/each}}
  </tbody>
</table>
</div>


{{!-- Confirm delete course --}} 
<div class="modal fade" id="delete-course-modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true"> 
  <div class="modal-dialog"> <div class="modal-content"> 
    <div class="modal-header"> 
      <h1 class="modal-title fs-5" id="exampleModalLabel">Delete course?</h1> 
      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button> </div> 
      <div class="modal-body"> Are you sure you want to delete it? </div> 
      <div class="modal-footer"> 
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button> 
        <button type="button" class="btn btn-danger" id="btn-delete-course">Delete</button> 
        </div> 
        </div> 
        </div>
         </div>

{{!-- Delete hidden form --}} 
<form name="delete-course-form" method="POST"></form>

<script>
  document.addEventListener('DOMContentLoaded', function () { 
    var courseId; 
    var deleteForm = document.forms['delete-course-form']; 
    var btnDeleteCourse = document.getElementById('btn-delete-course');

    // When dialog confirm clicked
    const exampleModal = document.getElementById('delete-course-modal')
    if (exampleModal) {
        exampleModal.addEventListener('show.bs.modal', event => {
            const button = event.relatedTarget
            courseId = button.getAttribute('data-bs-whatever')
        })
    }

    // When delete course btn clicked
    btnDeleteCourse.onclick = function () {
        deleteForm.action = '/courses/' + courseId + '?_method=DELETE';
        deleteForm.submit();
    }
});
 
</script>